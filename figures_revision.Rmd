Load necessary libraries
```{r setup}
library(dplyr)
library(ggplot2)
library(cowplot)
library(gridExtra)
library(patchwork)
library(viridis)
library(writexl)
library(xlsx)
library(readxl)
```

ANALYTICAL REALIZATIONS

First we import data for the exemplars of the analytic realizations. 
Defined AA, AB, and AC.

```{r}
setwd("/Users/XXX/WES Project Folder")

# file.csv should be replaced with the desired .csv output from the simulation code (python)

# AA: symmetric dynamics and symmetric costs (r1 = r2 = 0.2, eta = 0.01)
fig_AA_df = read.csv("file.csv") 

# AB: asymmetric WES costs  (r1 = r2 = 0.2, eta = 0.01)
fig_AB_df = read.csv("file.csv")

# AC: asymmetric disease dynamics (r1 = 0.4, r2 = 0.2, eta = 0.003)
fig_AC_df = read.csv("file.csv")

```

And find the respective minima and best response curves for AA-C.

```{r}

# figure AA
  # best response curve for patch 1
  min1AA = fig_AA_df %>% 
    filter(!(patch.one.cost == Inf)) %>% # infinite values are not minima
    group_by(rate.two) %>%
    filter(patch.one.cost == min(patch.one.cost)) %>%
    arrange(rate.two)
  # best response curve for patch 2
  min2AA = fig_AA_df %>% 
    filter(!(patch.two.cost == Inf)) %>%
    group_by(rate.one) %>%
    filter(patch.two.cost == min(patch.two.cost)) %>%
    arrange(rate.one) 
  # globally optimal strategy
  minAA = fig_AA_df %>% filter(total.costs == min(total.costs))
  # manually set reasonable contour break values
  breaksAA = c(1000, 1200, 1400, 1600, 1750, 2000, 3000, 100000, 420000, Inf)
  # repeat for AB and AC

# figure AB
  min1AB = fig_AB_df %>% 
    filter(!(patch.one.cost == Inf)) %>%
    group_by(rate.two) %>%
    filter(patch.one.cost == min(patch.one.cost)) %>%
    arrange(rate.two)
  min2AB = fig_AB_df %>% 
    filter(!(patch.two.cost == Inf)) %>%
    group_by(rate.one) %>%
    filter(patch.two.cost == min(patch.two.cost)) %>%
    arrange(rate.one) 
  minAB = fig_AB_df %>% filter(total.costs == min(total.costs))
  breaksAB = c(1900, 2250, 2500, 2750, 3000, 4000, 6000, 12000, 50000, 420000, Inf)

# figure AC
  min1AC = fig_AC_df %>% 
    filter(!(patch.one.cost == Inf)) %>%
    group_by(rate.two) %>%
    filter(patch.one.cost == min(patch.one.cost)) %>%
    arrange(rate.two) 
  min2AC = fig_AC_df %>% 
    filter(!(patch.two.cost == Inf)) %>%
    group_by(rate.one) %>%
    filter(patch.two.cost == min(patch.two.cost)) %>%
    arrange(rate.one)  
  minAC = fig_AC_df %>% filter(total.costs == min(total.costs))
  breaksAC = c(1300, 1400, 1500, 1600, 1700, 1800, 2000, 3000, 4000, 6000, Inf)

```

Figure 1

```{r}

  figAA = ggplot(fig_AA_df, aes(x = rate.one, y = rate.two)) +
    geom_contour(aes(z = total.costs, color = factor(after_stat(level))), breaks = breaksAA, linewidth = 1) +
    scale_color_viridis_d(option = "magma") +
    geom_path(data = min1AA, aes(x = rate.one, y = rate.two), group = 1, color = "black", linewidth = 1, linetype = "dashed") +
    geom_path(data = min2AA, aes(x = rate.one, y = rate.two), group = 1, color = "black", linewidth = 1, linetype = "dotted") +
    geom_point(data = minAA, aes(x = rate.one, y = rate.two), color = "red", size = 4, shape = 23, fill = "red") +
    theme_minimal() +
    theme(legend.position = "none",
           axis.text=element_text(size = 15),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank()) +
    xlim(0, 3) + ylim(0, 3) 

  figAB = ggplot(fig_AB_df, aes(x = rate.one, y = rate.two)) +
    geom_contour(aes(z = total.costs, color = factor(after_stat(level))), breaks = breaksAB, linewidth = 1) +
    scale_color_viridis_d(option = "magma") +
    geom_path(data = min1AB, aes(x = rate.one, y = rate.two), group = 1, color = "black", linewidth = 1, linetype = "dashed") +
    geom_path(data = min2AB, aes(x = rate.one, y = rate.two), group = 1, color = "black", linewidth = 1, linetype = "dotted") +
    geom_point(data = minAB, aes(x = rate.one, y = rate.two), color = "red", size = 4, shape = 23, fill = "red") +
    theme_minimal() +
    theme(legend.position = "none",
           axis.text=element_text(size = 15),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank()) +
    xlim(0, 3) + ylim(0, 3)
  
  figAC = ggplot(fig_AC_df, aes(x = rate.one, y = rate.two)) +
    geom_contour(aes(z = total.costs, color = factor(after_stat(level))), breaks = breaksAC, linewidth = 1) +
    scale_color_viridis_d(option = "magma") +
    geom_path(data = min1AC, aes(x = rate.one, y = rate.two), group = 1, color = "black", linewidth = 1, linetype = "dashed") +
    geom_path(data = min2AC, aes(x = rate.one, y = rate.two), group = 1, color = "black", linewidth = 1, linetype = "dotted") +
    geom_point(data = minAC, aes(x = rate.one, y = rate.two), color = "red", size = 4, shape = 23, fill = "red") +
    theme_minimal() +
    theme(legend.position = "none",
          axis.text=element_text(size = 15),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank()) +
    xlim(0, 3) + ylim(0, 3)
  
  figure1 = figAA | figAB | figAC

  setwd("/Users/XXX/WES Project Folder/Figures")
  ggsave("figure1_R.svg", figure1, width = 10, height = 4)
  
```

NUMERICAL SIMULATIONS

Then we import data from the numerical simulations.
And we define scenarios A-BG.

```{r}
setwd("/Users/XXX/WES Project Folder")

# for importing files below, symmetric disease dynamics refers to r1 = r2 = 0.2, and asymmetric refers to r1 = 0.4 and r2 = 0.2
# eta is called "interaction", as indicated
# file.csv should be replaced with the desired .csv output from the simulation code (python)

# A: asymmetric disease dynamics (interaction 0)
fig_A_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size) 
# B: asymmetric disease dynamics (interaction 0.001)
fig_B_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size) 
# C: asymmetric disease dynamics (interaction 0.003)
fig_C_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size) 
# D: asymmetric disease dynamics (interaction 0.005)
fig_D_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size) 
# E: asymmetric disease dynamics (interaction 0.01)
fig_E_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size) 
# BA: asymmetric disease dynamics (interaction 0.05)
fig_BA_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size) 
# BB: asymmetric disease dynamics (interaction 0.1)
fig_BB_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size) 

# F: symmetric disease dynamics, asymmetric WES costs (interaction 0.)
fig_F_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size)
# G: symmetric disease dynamics (interaction 0.001)
fig_G_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size)
# H: symmetric disease dynamics (interaction 0.003)
fig_H_df = read.csv("file.csv")%>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size)
# I: symmetric disease dynamics (interaction 0.005)
fig_I_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size)
# J: symmetric disease dynamics (interaction 0.01)
fig_J_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size)
# W: symmetric disease dynamics (interaction 0.05)
fig_W_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size)
# X: symmetric disease dynamics (interaction 0.1)
fig_X_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size)

# K: symmetric disease dynamics, asymmetric disease costs (interaction 0)
fig_K_df = fig_F_df
# L: symmetric disease dynamics (interaction 0.001)
fig_L_df = fig_G_df
# M: symmetric disease dynamics (interaction 0.003)
fig_M_df = fig_H_df
# N: symmetric disease dynamics (interaction 0.005)
fig_N_df = fig_I_df
# O: symmetric disease dynamics (interaction 0.01)
fig_O_df = fig_J_df
# Y: symmetric disease dynamics (interaction 0.05)
fig_Y_df = fig_W_df
# Z: symmetric disease dynamics (interaction 0.1)
fig_Z_df = fig_X_df

# P: asymmetric disease dynamics, high setup costs (interaction 0)
fig_P_df = fig_A_df
# Q: asymmetric disease dynamics (interaction 0.001)
fig_Q_df = fig_B_df
# R: asymmetric disease dynamics (interaction 0.003)
fig_R_df = fig_C_df
# S: asymmetric disease dynamics (interaction 0.005)
fig_S_df = fig_D_df
# T: asymmetric disease dynamics (interaction 0.01)
fig_T_df = fig_E_df

# asymmetric dynamics (interaction 0.002)
fig_V_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size)

# FALSE POSITIVE SCENARIOS
  # BC: false pos 2%, symmetric dynamics (r = 0.2, eta = 0.1)
  fig_BC_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
  # BD: false pos 5%, symmetric dynamics (r = 0.2, eta = 0.1)
  fig_BD_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
  # BE: false pos 10%, symmetric dynamics (r = 0.2, eta = 0.1)
  fig_BE_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
  # false positive scenarios where more than one 'vote' is required
  # BF: false pos 2%, symmetric dynamics (r = 0.2, eta = 0.1), votes = 2
  fig_BF_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
  # BG: false pos 2%, symmetric dynamics (r = 0.2, eta = 0.1), votes = 3
  fig_BG_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
  # asym dynamics
  # BH: false pos 2%, asymmetric dynamics (r1 = 0.4, r2 = 0.2, eta = 0.01)
  fig_BH_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
  # BI: false pos 5%, asymmetric dynamics (r1 = 0.4, r2 = 0.2, eta = 0.01)
  fig_BI_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
  # BJ: false pos 10%, asymmetric dynamics (r1 = 0.4, r2 = 0.2, eta = 0.01)
  fig_BJ_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
# false positive scenarios where more than one 'vote' is required
  # BK: false pos 2%, asymmetric dynamics (r1 = 0.4, r2 = 0.2, eta = 0.01), votes = 2
  fig_BK_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  
  # BL: false pos 2%, asymmetric dynamics (r1 = 0.4, r2 = 0.2, eta = 0.01), votes = 3
  fig_BL_df = read.csv("file.csv") %>% rename(rate.one = Freq1, rate.two = Freq2, tdetection = DetTime, cases.one = Patch1Size, cases.two = Patch2Size, overall_fp_perc = `FalsePos.`)
  

```

Compute the costs for A-BL.
```{r}
# set up a loop
  # list of letters
  fignames = LETTERS
    fignames[27] = "BA"
    fignames[28] = "BB"
    fignames[29] = "BC"
    fignames[30] = "BD"
    fignames[31] = "BE"
    fignames[32] = "BF"
    fignames[33] = "BG"
    fignames[34] = "BH"
    fignames[35] = "BI"
    fignames[36] = "BJ"
    fignames[37] = "BK"
    fignames[38] = "BL"
  # list of figure dfs
  figdfs = fignames
    for (i in 1:length(fignames)) {
      figdfs[i] = paste0("fig_", fignames[i], "_df")
    }

# set parameter values
  k.one = 50
  k.two = 50
  a.one = 50
  a.two = 50
  c.one = 10
  c.two = 10
  false.penalty = 50000 # $5 pp
  
# A-E and V, BA, and BB
  asym = c(1:5, 24, 22, 27, 28)
  for (i in asym) {
    df = get(figdfs[i])
    df = df %>% 
      mutate(WES.cost.one = k.one + a.one * rate.one * tdetection,
             WES.cost.two = k.two + a.two * rate.two * tdetection,
             WES.cost.one = ifelse(rate.one == 0, 0, WES.cost.one),
             WES.cost.two = ifelse(rate.two == 0, 0, WES.cost.two),
             
             dis.cost.one = c.one * cases.one,
             dis.cost.two = c.two * cases.two,
             
             patch.one.cost = WES.cost.one + dis.cost.one,
             patch.two.cost = WES.cost.two + dis.cost.two,
             
             total.costs = patch.one.cost + patch.two.cost,
             
             evsi.one = max(dis.cost.one) - dis.cost.one,
             evsi.two = max(dis.cost.two) - dis.cost.two,
             evsi = max(dis.cost.one + dis.cost.two) - (dis.cost.one + dis.cost.two),
             
             engs.one = evsi.one - WES.cost.one,
             engs.two = evsi.two - WES.cost.two,
             engs = evsi - (WES.cost.one + WES.cost.two))
    assign(figdfs[i], df) 
  }
  
# repeated as above, but with penalty for false positives (for BC-BG)
  asym = c(29:38)
  for (i in asym) {
    df = get(figdfs[i])
    df = df %>% 
      mutate(WES.cost.one = k.one + a.one * rate.one * tdetection,
             WES.cost.two = k.two + a.two * rate.two * tdetection,
             WES.cost.one = ifelse(rate.one == 0, 0, WES.cost.one),
             WES.cost.two = ifelse(rate.two == 0, 0, WES.cost.two),
             
             dis.cost.one = c.one * cases.one,
             dis.cost.two = c.two * cases.two,
             
             patch.one.cost = WES.cost.one + dis.cost.one,
             patch.two.cost = WES.cost.two + dis.cost.two,
             
             false.pos.cost = false.penalty * overall_fp_perc,
             
             total.costs = patch.one.cost + patch.two.cost + false.pos.cost,
             
             evsi = max(dis.cost.one + dis.cost.two) - (dis.cost.one + dis.cost.two) - false.pos.cost,
             
             engs = evsi - (WES.cost.one + WES.cost.two))
    assign(figdfs[i], df) 
  }
  
# F-J
  wes = c(6:10, 23)
  a.one = 200
  for (i in wes) {
    df = get(figdfs[i])
    df = df %>% 
      mutate(WES.cost.one = k.one + a.one * rate.one * tdetection,
             WES.cost.two = k.two + a.two * rate.two * tdetection,
             WES.cost.one = ifelse(rate.one == 0, 0, WES.cost.one),
             WES.cost.two = ifelse(rate.two == 0, 0, WES.cost.two),
             
             dis.cost.one = c.one * cases.one,
             dis.cost.two = c.two * cases.two,
             
             patch.one.cost = WES.cost.one + dis.cost.one ,
             patch.two.cost = WES.cost.two + dis.cost.two,
             
             total.costs = patch.one.cost + patch.two.cost,
             
             evsi.one = max(dis.cost.one) - dis.cost.one,
             evsi.two = max(dis.cost.two) - dis.cost.two,
             evsi = max(dis.cost.one + dis.cost.two) - (dis.cost.one + dis.cost.two),
             
             engs.one = evsi.one - WES.cost.one,
             engs.two = evsi.two - WES.cost.two,
             engs = evsi - (WES.cost.one + WES.cost.two))
    assign(figdfs[i], df) 
  }
  
# K-O
  dis = c(11:15, 25, 26)
  a.one = 50
  c.one = 5
  for (i in dis) {
    df = get(figdfs[i])
    df = df %>% 
      mutate(WES.cost.one = k.one + a.one * rate.one * tdetection,
             WES.cost.two = k.two + a.two * rate.two * tdetection,
             WES.cost.one = ifelse(rate.one == 0, 0, WES.cost.one),
             WES.cost.two = ifelse(rate.two == 0, 0, WES.cost.two),
             
             dis.cost.one = c.one * cases.one,
             dis.cost.two = c.two * cases.two,
             
             patch.one.cost = WES.cost.one + dis.cost.one,
             patch.two.cost = WES.cost.two + dis.cost.two,
             
             total.costs = patch.one.cost + patch.two.cost,
             
             evsi.one = max(dis.cost.one) - dis.cost.one,
             evsi.two = max(dis.cost.two) - dis.cost.two,
             evsi = max(dis.cost.one + dis.cost.two) - (dis.cost.one + dis.cost.two),
             
             engs.one = evsi.one - WES.cost.one,
             engs.two = evsi.two - WES.cost.two,
             engs = evsi - (WES.cost.one + WES.cost.two))
    assign(figdfs[i], df) 
  }

  
# P-T
  c.one = 10
  k.one = 150
  k.two = 50
  for (i in 16:20) {
    df = get(figdfs[i])
    df = df %>% 
      mutate(WES.cost.one = k.one + a.one * rate.one * tdetection,
             WES.cost.two = k.two + a.two * rate.two * tdetection,
             WES.cost.one = ifelse(rate.one == 0, 0, WES.cost.one),
             WES.cost.two = ifelse(rate.two == 0, 0, WES.cost.two),
             
             dis.cost.one = c.one * cases.one,
             dis.cost.two = c.two * cases.two,
             
             patch.one.cost = WES.cost.one + dis.cost.one,
             patch.two.cost = WES.cost.two + dis.cost.two,
             
             total.costs = patch.one.cost + patch.two.cost,
             
             evsi.one = max(dis.cost.one) - dis.cost.one,
             evsi.two = max(dis.cost.two) - dis.cost.two,
             evsi = max(dis.cost.one + dis.cost.two) - (dis.cost.one + dis.cost.two),
             
             engs.one = evsi.one - WES.cost.one,
             engs.two = evsi.two - WES.cost.two,
             engs = evsi - (WES.cost.one + WES.cost.two))
    assign(figdfs[i], df) 
  }  
  
  k.one = 50
  k.two = 50
  fig_U_df = fig_F_df %>%
      select(rate.one, rate.two, cases.one, cases.two, tdetection) %>%
      mutate(WES.cost.one = k.one + a.one * rate.one * tdetection,
             WES.cost.two = k.two + a.two * rate.two * tdetection,
             WES.cost.one = ifelse(rate.one == 0, 0, WES.cost.one),
             WES.cost.two = ifelse(rate.two == 0, 0, WES.cost.two),
             
             dis.cost.one = c.one * cases.one,
             dis.cost.two = c.two * cases.two,
             
             patch.one.cost = WES.cost.one + dis.cost.one,
             patch.two.cost = WES.cost.two + dis.cost.two,
             
             total.costs = patch.one.cost + patch.two.cost,
             
             evsi.one = max(dis.cost.one) - dis.cost.one,
             evsi.two = max(dis.cost.two) - dis.cost.two,
             evsi = max(dis.cost.one + dis.cost.two) - (dis.cost.one + dis.cost.two),
             
             engs.one = evsi.one - WES.cost.one,
             engs.two = evsi.two - WES.cost.two,
             engs = evsi - (WES.cost.one + WES.cost.two))
```

And find the respective minima and best response curves for A-BL.

```{r}

for (i in 1:length(figdfs)) {
    # get the current df
    df = get(figdfs[i])
  
    min1 = df %>% 
      group_by(rate.two) %>%
      filter(patch.one.cost == min(patch.one.cost)) %>%
      arrange(rate.two) 
  
    min2 = df %>% 
      group_by(rate.one) %>%
      filter(patch.two.cost == min(patch.two.cost)) %>%
      arrange(rate.one) 
    
    min = df %>% filter(total.costs == min(total.costs))
    
    assign(paste0("min1", fignames[i]), min1)
    assign(paste0("min2", fignames[i]), min2)
    assign(paste0("min", fignames[i]), min)
      
  }

# define breaks
bk = c(2800, 3000, 3300, 3700, 4000, 4500, 5000, 7500, 9000, 10000, 20000)
# for fig S4 only
bk2 = c(100000, 130000, 132000, 134000, 136000, 138000, 140000, 142000, 146000, 148000)
# for fig S1I-L only
bk3 = c(7000, 8500, 10000, 12000, 16000, 20000, 30000, 50000)
```

Then generate all panels A-BL.

```{r}

for (i in 1:length(fignames)) {
    df = get(figdfs[i])
    
    min = get(paste0("min", fignames[i]))
    min1 = get(paste0("min1", fignames[i]))
    min2 = get(paste0("min2", fignames[i]))

    fig = ggplot(df, aes(x = rate.one, y = rate.two)) +
      geom_contour(aes(z = total.costs, color = factor(after_stat(level))), breaks = bk, linewidth = 1) +
      scale_color_viridis_d() +
      geom_path(data = min1, aes(x = rate.one, y = rate.two), group = 1, color = "black", linewidth = 1, linetype = "dashed") +
      geom_path(data = min2, aes(x = rate.one, y = rate.two), group = 1, color = "black", linewidth = 1, linetype = "dotted") +
      geom_point(data = min, aes(x = rate.one, y = rate.two), color = "red", size = 4, shape = 23, fill = "red") +
      theme_minimal() +
    theme(legend.position = "none",
          axis.text=element_text(size = 13),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank())
    
    assign(paste0("fig", fignames[i]), fig)
  
  }

```

Figure 2: asymmetric disease dynamics

```{r}
# asymmetric disease dynamics 0.001-0.01
figure2 = figB | figC | figD | figE

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figure2_R.svg", figure2, width = 12, height = 4)
    
```

Figure S2: asymmetric WES costs

```{r}
# asymmetric WES costs 0.001-0.1
figureS2top = figG | figH | figI
figureS2bot = figJ | figW | figX

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figureS2top_R.svg", figureS2top, width = 9, height = 4)
ggsave("figureS2bot_R.svg", figureS2bot, width = 9, height = 4)
    
```

Figure S1: high setup cost dropoff

```{r}
figureS1top = (figB | figC | figD | figE) 
figureS1bot = (figQ | figR | figS | figT)

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figureS1top_R.svg", figureS1top, width = 12, height = 4)
ggsave("figureS1bot_R.svg", figureS1bot, width = 12, height = 4)
    
```

Figure 3: asymmetric disease cost

```{r}
figure3top = ( figL | figM | figN ) 
figure3bot = ( figO | figY + geom_point(data = minY, aes(x = rate.two, y = rate.one), 
                                         color = "magenta", size = 4, shape = 23, fill = "magenta") | 
                figZ + geom_point(data = minZ, aes(x = rate.two, y = rate.one), 
                                  color = "magenta", size = 4, shape = 23, fill = "magenta"))

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figure3_Rtop.svg", figure3top, width = 9, height = 4)
ggsave("figure3_Rbot.svg", figure3bot, width = 9, height = 4)
    
```

Figure 4A and Figure S3A: increasing false positivity rates
```{r}

# set up the data frame
figure4_df = data.frame(falsepos = as.factor(rep(c(0, 2, 5, 10), each = 2)),
                         patch = as.factor(rep(c(1, 2), times = 4))) %>%
  # then add in the actual values 
  mutate(freq = c(fig_E_df$rate.one[which.min(fig_E_df$total.costs)],
                  fig_E_df$rate.two[which.min(fig_E_df$total.costs)],
                  fig_BH_df$rate.one[which.min(fig_BH_df$total.costs)],
                  fig_BH_df$rate.two[which.min(fig_BH_df$total.costs)],
                  fig_BI_df$rate.one[which.min(fig_BI_df$total.costs)],
                  fig_BI_df$rate.two[which.min(fig_BI_df$total.costs)],
                  fig_BJ_df$rate.one[which.min(fig_BJ_df$total.costs)],
                  fig_BJ_df$rate.two[which.min(fig_BJ_df$total.costs)]),
         total.costs = c(fig_E_df$total.costs[which.min(fig_E_df$total.costs)],
                          fig_E_df$total.costs[which.min(fig_E_df$total.costs)],
                          fig_BH_df$total.costs[which.min(fig_BH_df$total.costs)],
                          fig_BH_df$total.costs[which.min(fig_BH_df$total.costs)],
                          fig_BI_df$total.costs[which.min(fig_BI_df$total.costs)],
                          fig_BI_df$total.costs[which.min(fig_BI_df$total.costs)],
                          fig_BJ_df$total.costs[which.min(fig_BJ_df$total.costs)],
                          fig_BJ_df$total.costs[which.min(fig_BJ_df$total.costs)]))

scale_factor = max(figure4_df$freq) / max(figure4_df$total.costs)

figure4 = ggplot(figure4_df, aes(x = falsepos, group = patch, fill = patch)) +
  geom_bar(aes(y = freq), stat = "identity", position = "dodge", color = "black") +
  scale_fill_manual(values = c("#fde725", "#440154")) +
  geom_point(aes(y = total.costs * scale_factor), 
             position = position_dodge(width = 0),
             shape = 21, fill = "#21918c", size = 4) +
  scale_y_continuous(name = "Optimal Sampling Frequency", sec.axis = sec_axis(~ . / scale_factor, name = "Total Costs (both patches)")) +
  theme_minimal() +
  labs(x = "False Positive Risk (percentage)") +
  theme(legend.position = "none", 
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        axis.title.x = element_text(face = "bold"),
        axis.title.y.left = element_text(face = "bold"),
        axis.title.y.right = element_text(face = "bold"),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"))

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figure4_R.svg", figure4, width = 6, height = 3)


# repeat for figure S3, set up the data frame
figureS3_df = data.frame(falsepos = as.factor(rep(c(0, 2, 5, 10), each = 2)),
                         patch = as.factor(rep(c(1, 2), times = 4))) %>%
  # then add in the actual values 
  mutate(freq = c(fig_X_df$rate.one[which.min(fig_X_df$total.costs)],
                  fig_X_df$rate.two[which.min(fig_X_df$total.costs)],
                  fig_BC_df$rate.one[which.min(fig_BC_df$total.costs)],
                  fig_BC_df$rate.two[which.min(fig_BC_df$total.costs)],
                  fig_BD_df$rate.one[which.min(fig_BD_df$total.costs)],
                  fig_BD_df$rate.two[which.min(fig_BD_df$total.costs)],
                  fig_BE_df$rate.one[which.min(fig_BE_df$total.costs)],
                  fig_BE_df$rate.two[which.min(fig_BE_df$total.costs)]),
         total.costs = c(fig_X_df$total.costs[which.min(fig_X_df$total.costs)],
                          fig_X_df$total.costs[which.min(fig_X_df$total.costs)],
                          fig_BC_df$total.costs[which.min(fig_BC_df$total.costs)],
                          fig_BC_df$total.costs[which.min(fig_BC_df$total.costs)],
                          fig_BD_df$total.costs[which.min(fig_BD_df$total.costs)],
                          fig_BD_df$total.costs[which.min(fig_BD_df$total.costs)],
                          fig_BE_df$total.costs[which.min(fig_BE_df$total.costs)],
                          fig_BE_df$total.costs[which.min(fig_BE_df$total.costs)]))

scale_factor = max(figureS3_df$freq) / max(figureS3_df$total.costs)

figureS3 = ggplot(figureS3_df, aes(x = falsepos, group = patch, fill = patch)) +
  geom_bar(aes(y = freq), stat = "identity", position = "dodge", color = "black") +
  scale_fill_manual(values = c("#fde725", "#440154")) +
  geom_point(aes(y = total.costs * scale_factor), 
             position = position_dodge(width = 0),
             shape = 21, fill = "#21918c", size = 4) +
  scale_y_continuous(name = "Optimal Sampling Frequency", sec.axis = sec_axis(~ . / scale_factor, name = "Total Costs (both patches)")) +
  theme_minimal() +
  labs(x = "False Positive Risk (percentage)") +
  theme(legend.position = "none", 
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        axis.title.x = element_text(face = "bold"),
        axis.title.y.left = element_text(face = "bold"),
        axis.title.y.right = element_text(face = "bold"),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"))

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figureS3_R.svg", figureS3, width = 6, height = 3)

```

Figure 4B and Figure S3B: increasing number of votes required
```{r}

# set up the data frame
figure4B_df = data.frame(threshold = as.factor(rep(c(1, 2, 3), each = 2)),
                         patch = as.factor(rep(c(1, 2), times = 3))) %>%
  # then add in the actual values 
  mutate(freq = c(fig_BH_df$rate.one[which.min(fig_BH_df$total.costs)],
                  fig_BH_df$rate.two[which.min(fig_BH_df$total.costs)],
                  fig_BK_df$rate.one[which.min(fig_BK_df$total.costs)],
                  fig_BK_df$rate.two[which.min(fig_BK_df$total.costs)],
                  fig_BL_df$rate.one[which.min(fig_BL_df$total.costs)],
                  fig_BL_df$rate.two[which.min(fig_BL_df$total.costs)]),
         total.costs = c(fig_BH_df$total.costs[which.min(fig_BH_df$total.costs)],
                          fig_BH_df$total.costs[which.min(fig_BH_df$total.costs)],
                          fig_BK_df$total.costs[which.min(fig_BK_df$total.costs)],
                          fig_BK_df$total.costs[which.min(fig_BK_df$total.costs)],
                          fig_BL_df$total.costs[which.min(fig_BL_df$total.costs)],
                          fig_BL_df$total.costs[which.min(fig_BL_df$total.costs)]))

scale_factor = max(figure4B_df$freq) / max(figure4B_df$total.costs)

figure4B = ggplot(figure4B_df, aes(x = threshold, group = patch, fill = patch)) +
  geom_bar(aes(y = freq), stat = "identity", position = "dodge", color = "black") +
  scale_fill_manual(values = c("#fde725", "#440154")) +
  geom_point(aes(y = total.costs * scale_factor), 
             position = position_dodge(width = 0),
             shape = 21, fill = "#21918c", size = 4) +
  scale_y_continuous(name = "Optimal Sampling Frequency", sec.axis = sec_axis(~ . / scale_factor, name = "Total Costs (both patches)")) +
  theme_minimal() +
  labs(x = "Positive samples required for shutdown") +
  theme(legend.position = "none", 
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        axis.title.x = element_text(face = "bold"),
        axis.title.y.left = element_text(face = "bold"),
        axis.title.y.right = element_text(face = "bold"),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"))

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figure4B_R.svg", figure4B, width = 6, height = 3)


# repeat for figure S3B, set up the data frame
figureS3B_df = data.frame(threshold = as.factor(rep(c(1, 2, 3), each = 2)),
                         patch = as.factor(rep(c(1, 2), times = 3))) %>%
  # then add in the actual values 
  mutate(freq = c(fig_BD_df$rate.one[which.min(fig_BD_df$total.costs)],
                  fig_BD_df$rate.two[which.min(fig_BD_df$total.costs)],
                  fig_BF_df$rate.one[which.min(fig_BF_df$total.costs)],
                  fig_BF_df$rate.two[which.min(fig_BF_df$total.costs)],
                  fig_BG_df$rate.one[which.min(fig_BG_df$total.costs)],
                  fig_BG_df$rate.two[which.min(fig_BG_df$total.costs)]),
         total.costs = c(fig_BD_df$total.costs[which.min(fig_BD_df$total.costs)],
                          fig_BD_df$total.costs[which.min(fig_BD_df$total.costs)],
                          fig_BF_df$total.costs[which.min(fig_BF_df$total.costs)],
                          fig_BF_df$total.costs[which.min(fig_BF_df$total.costs)],
                          fig_BG_df$total.costs[which.min(fig_BG_df$total.costs)],
                          fig_BG_df$total.costs[which.min(fig_BG_df$total.costs)]))

scale_factor = max(figureS3B_df$freq) / max(figureS3B_df$total.costs)

figureS3B = ggplot(figureS3B_df, aes(x = threshold, group = patch, fill = patch)) +
  geom_bar(aes(y = freq), stat = "identity", position = "dodge", color = "black") +
  scale_fill_manual(values = c("#fde725", "#440154")) +
  geom_point(aes(y = total.costs * scale_factor), 
             position = position_dodge(width = 0),
             shape = 21, fill = "#21918c", size = 4) +
  scale_y_continuous(name = "Optimal Sampling Frequency", sec.axis = sec_axis(~ . / scale_factor, name = "Total Costs (both patches)")) +
  theme_minimal() +
  labs(x = "Positive samples required for shutdown") +
  theme(legend.position = "none", 
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        axis.title.x = element_text(face = "bold"),
        axis.title.y.left = element_text(face = "bold"),
        axis.title.y.right = element_text(face = "bold"),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"))

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figureS3B_R.svg", figureS3B, width = 6, height = 3)

```

Figure S4: no surveillance
```{r}
figureS4 = figBJ

setwd("/Users/XXX/WES Project Folder/Figures")
ggsave("figureS4_R.svg", figureS4, width = 3, height = 4)
    
```


VALUE OF INFORMATION ASSESSMENT

Make dataframes (no false positives)
```{r}
# a
  # choose parameter set
  figvoiA = c(1:5, 27, 28)
  nash = numeric(7)
  voi = list()
  index = 1
  
  # get and assign df of choice
  for (i in figvoiA) {
      min1 = get(paste0("min1", fignames[i]))
      min2 = get(paste0("min2", fignames[i]))
      df = get(paste0("fig_", fignames[i], "_df"))
      
      combine = inner_join(min1, min2, by = c("rate.one", "rate.two", "engs"))
      nash[index] = combine$engs
      voi[[index]] = df
      index = index + 1
  }
  
  
  figvoiA_df = data.frame(eta = c(0, 0.001, 0.003, 0.005, 0.01, 0.05, 0.1),
                        min_cost = c(min(voi[[1]]$total.costs), 
                                     min(voi[[2]]$total.costs), 
                                     min(voi[[3]]$total.costs), 
                                     min(voi[[4]]$total.costs), 
                                     min(voi[[5]]$total.costs), 
                                     min(voi[[6]]$total.costs), 
                                     min(voi[[7]]$total.costs)),
                        max_engs = c(max(voi[[1]]$engs), 
                                     max(voi[[2]]$engs), 
                                     max(voi[[3]]$engs), 
                                     max(voi[[4]]$engs), 
                                     max(voi[[5]]$engs), 
                                     max(voi[[6]]$engs), 
                                     max(voi[[7]]$engs)),
                        t_detection = c(mean(voi[[1]]$tdetection), 
                                     mean(voi[[2]]$tdetection), 
                                     mean(voi[[3]]$tdetection), 
                                     mean(voi[[4]]$tdetection), 
                                     mean(voi[[5]]$tdetection), 
                                     mean(voi[[6]]$tdetection), 
                                     mean(voi[[7]]$tdetection)),
                        sum_cases = c(mean(voi[[1]]$cases.one + voi[[1]]$cases.two), 
                                     mean(voi[[2]]$tdetection + voi[[2]]$cases.two), 
                                     mean(voi[[3]]$tdetection + voi[[3]]$cases.two), 
                                     mean(voi[[4]]$tdetection + voi[[4]]$cases.two), 
                                     mean(voi[[5]]$tdetection + voi[[5]]$cases.two), 
                                     mean(voi[[6]]$tdetection + voi[[6]]$cases.two), 
                                     mean(voi[[7]]$tdetection + voi[[7]]$cases.two)),
                        delta_case = c(mean(abs(voi[[1]]$cases.one - voi[[1]]$cases.two)), 
                                     mean(abs(voi[[2]]$cases.one - voi[[2]]$cases.two)), 
                                     mean(abs(voi[[3]]$cases.one - voi[[3]]$cases.two)), 
                                     mean(abs(voi[[4]]$cases.one - voi[[4]]$cases.two)), 
                                     mean(abs(voi[[5]]$cases.one - voi[[5]]$cases.two)), 
                                     mean(abs(voi[[6]]$cases.one - voi[[6]]$cases.two)), 
                                     mean(abs(voi[[7]]$cases.one - voi[[7]]$cases.two))),
                        nash_engs = nash) %>%
            mutate(delta = max_engs - nash_engs)

# b  
  figvoiB = c(6:10, 23, 24)
  nash = numeric(7)
  voi = list()
  index = 1
  
  # get and assign df of choice
  for (i in figvoiB) {
      min1 = get(paste0("min1", fignames[i]))
      min2 = get(paste0("min2", fignames[i]))
      df = get(paste0("fig_", fignames[i], "_df"))
      
      combine = inner_join(min1, min2, by = c("rate.one", "rate.two", "engs"))
      nash[index] = combine$engs
      voi[[index]] = df
      index = index + 1
  }
  
  
  figvoiB_df = data.frame(eta = c(0, 0.001, 0.003, 0.005, 0.01, 0.05, 0.1),
                        min_cost = c(min(voi[[1]]$total.costs), 
                                     min(voi[[2]]$total.costs), 
                                     min(voi[[3]]$total.costs), 
                                     min(voi[[4]]$total.costs), 
                                     min(voi[[5]]$total.costs), 
                                     min(voi[[6]]$total.costs), 
                                     min(voi[[7]]$total.costs)),
                        max_engs = c(max(voi[[1]]$engs), 
                                     max(voi[[2]]$engs), 
                                     max(voi[[3]]$engs), 
                                     max(voi[[4]]$engs), 
                                     max(voi[[5]]$engs), 
                                     max(voi[[6]]$engs), 
                                     max(voi[[7]]$engs)),
                        t_detection = c(mean(voi[[1]]$tdetection), 
                                     mean(voi[[2]]$tdetection), 
                                     mean(voi[[3]]$tdetection), 
                                     mean(voi[[4]]$tdetection), 
                                     mean(voi[[5]]$tdetection), 
                                     mean(voi[[6]]$tdetection), 
                                     mean(voi[[7]]$tdetection)),
                      sum_cases = c(mean(voi[[1]]$cases.one + voi[[1]]$cases.two), 
                                     mean(voi[[2]]$tdetection + voi[[2]]$cases.two), 
                                     mean(voi[[3]]$tdetection + voi[[3]]$cases.two), 
                                     mean(voi[[4]]$tdetection + voi[[4]]$cases.two), 
                                     mean(voi[[5]]$tdetection + voi[[5]]$cases.two), 
                                     mean(voi[[6]]$tdetection + voi[[6]]$cases.two), 
                                     mean(voi[[7]]$tdetection + voi[[7]]$cases.two)),
                        delta_case = c(mean(abs(voi[[1]]$cases.one - voi[[1]]$cases.two)), 
                                     mean(abs(voi[[2]]$cases.one - voi[[2]]$cases.two)), 
                                     mean(abs(voi[[3]]$cases.one - voi[[3]]$cases.two)), 
                                     mean(abs(voi[[4]]$cases.one - voi[[4]]$cases.two)), 
                                     mean(abs(voi[[5]]$cases.one - voi[[5]]$cases.two)), 
                                     mean(abs(voi[[6]]$cases.one - voi[[6]]$cases.two)), 
                                     mean(abs(voi[[7]]$cases.one - voi[[7]]$cases.two))),
                        nash_engs = nash) %>%
            mutate(delta = max_engs - nash_engs)
  
# c  
figvoiC = c(11:15, 25, 26)
  nash = numeric(7)
  voi = list()
  index = 1
  
  # get and assign df of choice
  for (i in figvoiC) {
      min1 = get(paste0("min1", fignames[i]))
      min2 = get(paste0("min2", fignames[i]))
      df = get(paste0("fig_", fignames[i], "_df"))
      
      combine = inner_join(min1, min2, by = c("rate.one", "rate.two", "engs"))
      nash[index] = combine$engs
      voi[[index]] = df
      index = index + 1
  }
  
  
  figvoiC_df = data.frame(eta = c(0, 0.001, 0.003, 0.005, 0.01, 0.05, 0.1),
                        min_cost = c(min(voi[[1]]$total.costs), 
                                     min(voi[[2]]$total.costs), 
                                     min(voi[[3]]$total.costs), 
                                     min(voi[[4]]$total.costs), 
                                     min(voi[[5]]$total.costs), 
                                     min(voi[[6]]$total.costs), 
                                     min(voi[[7]]$total.costs)),
                        max_engs = c(max(voi[[1]]$engs), 
                                     max(voi[[2]]$engs), 
                                     max(voi[[3]]$engs), 
                                     max(voi[[4]]$engs), 
                                     max(voi[[5]]$engs), 
                                     max(voi[[6]]$engs), 
                                     max(voi[[7]]$engs)),
                        t_detection = c(mean(voi[[1]]$tdetection), 
                                     mean(voi[[2]]$tdetection), 
                                     mean(voi[[3]]$tdetection), 
                                     mean(voi[[4]]$tdetection), 
                                     mean(voi[[5]]$tdetection), 
                                     mean(voi[[6]]$tdetection), 
                                     mean(voi[[7]]$tdetection)),
                        delta_case = c(mean(abs(voi[[1]]$cases.one - voi[[1]]$cases.two)), 
                                     mean(abs(voi[[2]]$cases.one - voi[[2]]$cases.two)), 
                                     mean(abs(voi[[3]]$cases.one - voi[[3]]$cases.two)), 
                                     mean(abs(voi[[4]]$cases.one - voi[[4]]$cases.two)), 
                                     mean(abs(voi[[5]]$cases.one - voi[[5]]$cases.two)), 
                                     mean(abs(voi[[6]]$cases.one - voi[[6]]$cases.two)), 
                                     mean(abs(voi[[7]]$cases.one - voi[[7]]$cases.two))),
                        nash_engs = nash) %>%
            mutate(delta = max_engs - nash_engs)
  
```

Figure S5: VOI in one patch
```{r}
  
  voi_df = fig_H_df
  
  figS5A_df = voi_df %>%
    filter(rate.two == 1)
  
  figS5A = ggplot(figS5A_df, aes(x = rate.one)) +
    geom_hline(yintercept = 49990, color = "#fde725", linewidth = 1) +
    geom_point(aes(y = evsi.one), color = "#1F9E89FF", size = 2) + geom_line(aes(y = evsi.one), color = "#1F9E89FF") +
    geom_point(aes(y = engs.one), color = "#440154FF", size = 2) + geom_line(aes(y = engs.one), color = "#440154FF") +
    geom_point(aes(y = WES.cost.one), color = "#6DCD59FF", size = 2) + geom_line(aes(y = WES.cost.one), color = "#6DCD59FF") +
    geom_vline(xintercept = figS5A_df$rate.one[which.max(figS5A_df$engs.one)], linetype = "dashed", color = "red") +
    theme_minimal() +
    theme(legend.position = "none") +
    labs(x = "testing frequency 1", y = "local costs")

 figS5B_df = voi_df %>%
   group_by(rate.two) %>%
   filter(engs.one == max(engs.one))
 
 figS5B = ggplot(figS5B_df, aes(x = rate.two, y = engs.one)) +
   geom_hline(yintercept = 49990, color = "#fde725", linewidth = 1) +
   geom_point(color = "#440154FF", size = 2) + geom_line(color = "#440154FF") +
    theme_minimal() +
    theme(legend.position = "none") +
    labs(x = "testing frequency 2", y = "max engs 1")
 
 
 figureS5 = figS5A + figS5B
 
  setwd("/Users/XXX/WES Project Folder/Figures")
  ggsave("figureS5_R.pdf", figureS5, width = 8, height = 4)
  
```

Figure 5: VOI in two patches
```{r}

  fig5C = ggplot(figvoiC_df, aes(x = eta)) +
      # geom_point(aes(y = min_cost), color = "#3E4A89FF", size = 2) + 
      # geom_line(aes(y = min_cost), color = "#3E4A89FF") +
      geom_point(aes(y = max_engs), color = "#1F9E89FF", size = 2) + 
  geom_line(aes(y = max_engs),color = "#1F9E89FF") +
      theme_minimal() +
      theme(legend.position = "none",
        axis.text=element_text(size = 10),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank())

  fig5B = ggplot(figvoiB_df, aes(x = eta)) +
      # geom_point(aes(y = min_cost), color = "#3E4A89FF", size = 2) + 
      # geom_line(aes(y = min_cost), color = "#3E4A89FF") +
      geom_point(aes(y = max_engs), color = "#1F9E89FF", size = 2) + 
    geom_line(aes(y = max_engs),color = "#1F9E89FF") +
      theme_minimal() +
      theme(legend.position = "none",
        axis.text=element_text(size = 10),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank())
  
  fig5A = ggplot(figvoiA_df, aes(x = eta)) +
      # geom_point(aes(y = min_cost), color = "#3E4A89FF", size = 2) + 
      # geom_line(aes(y = min_cost), color = "#3E4A89FF") +
      geom_point(aes(y = max_engs), color = "#1F9E89FF", size = 2) + 
      geom_line(aes(y = max_engs),color = "#1F9E89FF") +
      theme_minimal() +
      theme(legend.position = "none",
        axis.text=element_text(size = 10),
        axis.text.x = element_text(color = "black"), 
        axis.text.y = element_text(color = "black"),
        text = element_text(color = "black"), 
        axis.title.x = element_blank(),
        axis.title.y = element_blank())
  
  figure5 = fig5A + fig5B + fig5C
  
  setwd("/Users/XXX/WES Project Folder/Figures")
  ggsave("figure5_R.svg", figure5, width = 9, height = 4)

```

Figure S6: reflection

```{r}

  figS6 = ggplot(figS5A_df, aes(x = rate.one)) +
    geom_point(aes(y = engs.one), color = "#1F9E89FF", size = 2) + geom_line(aes(y = engs.one), color = "#1F9E89FF") +
    geom_point(aes(y = patch.one.cost), color = "#3E4A89FF", size = 2) + geom_line(aes(y = patch.one.cost), color = "#3E4A89FF") +
    theme_minimal() +
    theme(legend.position = "none") +
    labs(x = "testing frequency 1", y = "local costs")

  setwd("/Users/XXX/WES Project Folder/Figures")
  ggsave("figureS6_R.pdf", figS6, width = 5, height = 4)
```

Figure S7: avg detection time and delta case
```{r}
figureS7A = ggplot() +
  geom_point(data = figvoiA_df, aes(x = eta, y = t_detection), size = 2, color = "#365D8D") +
  geom_line(data = figvoiA_df, aes(x = eta, y = t_detection), color = "#365D8D") +
  geom_point(data = figvoiB_df, aes(x = eta, y = t_detection), size = 2, color = "#47C16E") +
  geom_line(data = figvoiB_df, aes(x = eta, y = t_detection), color = "#47C16E") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(x = "level of interaction", y = "average time of detection")

figureS7B = ggplot() +
  geom_point(data = figvoiA_df, aes(x = eta, y = sum_cases), size = 2, color = "#365D8D") +
  geom_line(data = figvoiA_df, aes(x = eta, y = sum_cases), color = "#365D8D") +
  geom_point(data = figvoiB_df, aes(x = eta, y = sum_cases), size = 2, color = "#47C16E") +
  geom_line(data = figvoiB_df, aes(x = eta, y = sum_cases), color = "#47C16E") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(x = "level of interaction", y = "average cases upon detection (both patches)")

figureS7C = ggplot() +
  geom_point(data = figvoiA_df, aes(x = eta, y = delta_case), size = 2, color = "#365D8D") +
  geom_line(data = figvoiA_df, aes(x = eta, y = delta_case), color = "#365D8D") +
  geom_point(data = figvoiB_df, aes(x = eta, y = delta_case), size = 2, color = "#47C16E") +
  geom_line(data = figvoiB_df, aes(x = eta, y = delta_case), color = "#47C16E") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(x = "level of interaction", y = "average difference between patches")

figureS7 = figureS7A + figureS7B + figureS7C

  setwd("/Users/XXX/WES Project Folder/Figures")
  ggsave("figureS7_R.pdf", figureS7, width = 10, height = 4)

```

Figure S8: delta

```{r}
  
  figS8A = ggplot(figvoiA_df, aes(x = eta, y = delta)) +
      geom_point(color = "#440154FF", size = 2) + geom_line(color = "#440154FF") +
      theme_minimal() +
      theme(legend.position = "none") +
      labs(x = "interaction constant", y = "Delta (Nash)")

  figS8B = ggplot(figvoiB_df, aes(x = eta, y = delta)) +
      geom_point(color = "#440154FF", size = 2) + geom_line(color = "#440154FF") +
      theme_minimal() +
      theme(legend.position = "none") +
      labs(x = "interaction constant", y = "Delta (Nash)")

  figS8C = ggplot(figvoiC_df, aes(x = eta, y = delta)) +
      geom_point(color = "#440154FF", size = 2) + geom_line(color = "#440154FF") +
      theme_minimal() +
      theme(legend.position = "none") +
      labs(x = "interaction constant", y = "Delta (Nash)")
  
  figureS8 = figS8A + figS8B + figS8C
  
  setwd("/Users/XXX/WES Project Folder/Figures")
  ggsave("figureS8_R.pdf", figureS8, width = 11, height = 4)
```

Figure S9: uncoupled

```{r}

figureS9 = figU + figA + figF + figK

  setwd("/Users/XXX/WES Project Folder/Figures")
  ggsave("figureS9_R.svg", figureS9, width = 8, height = 9)


```
